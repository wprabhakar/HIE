{"version":3,"sources":["../../src/pages/order-history/order-history.module.ts","../../src/pages/order-history/order-history.ts"],"names":[],"mappings":"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","file":"14.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { OrderHistoryPage } from './order-history';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    OrderHistoryPage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(OrderHistoryPage),\r\n  ],\r\n  exports: [\r\n    OrderHistoryPage\r\n  ]\r\n})\r\nexport class OrderHistoryPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/order-history/order-history.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, LoadingController, Loading } from 'ionic-angular';\nimport { APIService } from '../../providers/api-service';\nimport { lookupTime } from '../../app/properties';\n//import { lookupStatus } from '../../app/properties';\n\n@IonicPage()\n@Component({\n  selector: 'page-order-history',\n  templateUrl: 'order-history.html'\n})\nexport class OrderHistoryPage {\n  public oItems: any[] = [];\n  private bLoaded = false;\n  private oItemGroupedByDate: any ;\n  bSearching: boolean = false ;\n  sText: string = '';\n  oAllItems: any[] = [];\n  loading: Loading;\n\n  sErrorText: string = 'NO RESULT' ;\n  constructor(public navCtrl: NavController, public oAPIService: APIService,     private readonly loadingCtrl: LoadingController,\n  ) {\n  }\n\n  ionViewDidLoad() {\n    this.fetchItems();\n  }\n  goBack() {\n    this.navCtrl.pop();\n  }\n  fetchItems() {\n    this.loading = this.loadingCtrl.create({\n      content: 'loading...',\n    });\n    this.loading.present();\n    this.oItems = [];\n    this.oAllItems = [] ;\n    this.bLoaded = false;\n    this.oAPIService.send2ServerP(\"merchant/orders\", true, { STATUS: 'D' }).then((data: any) => {\n      if ( data.result.length == 0 )\n      {\n        this.oItemGroupedByDate = [] ;        \n        this.loading.dismissAll() ;\n        this.bLoaded = true ;\n        return ;\n      }\n      this.oAPIService.sort(data.result, [{ field: 'PICKUPON', direction: 'desc' }, { field: 'PICKUPSTART', direction: 'desc' }, { field: 'BOOKINGREF', direction: 'desc' }]);\n      this.oItems = data.result ;\n      this.oAllItems = data.result ;\n      this.oItems.forEach((obj, idx) => {\n        obj.PICKUPTIME = lookupTime(obj.PICKUPSTART);\n        if (idx == this.oItems.length - 1) {\n          this.oItemGroupedByDate = this.groupByDate();\n          this.loading.dismissAll() ;\n          this.bLoaded = true;\n        }\n      });\n    }).catch((err) => {\n      console.log('Error:' + JSON.stringify(err));\n      this.loading.dismissAll() ;\n    });\n  }\n  groupByDate ( )\n  {\n    var groups = this.oItems.reduce ( function ( o, a ) \n    {\n      var m = a.PICKUPON ;\n      ( o[m] ) ? o[m].data.push(a) : o[m] = { PICKUPON: m, data:[a]} ;\n      return o ;\n    }, {} ) ;\n    var result = Object.keys(groups).map ( function (k) {\n      return groups[k] ;\n    })  ;\n    return result ;\n }\n  getStyle(sPickupOn: string): string\n  {\n  //  console.log ( sPickupOn ) ;\n    var inputDate = new Date(sPickupOn);\n    var todaysDate = new Date();\n\n    var bToday = (inputDate.setHours(0,0,0,0) == todaysDate.setHours(0,0,0,0));\n\n    if ( bToday )\n      return \"ksd-back-1\" ;\n    return \"ksd-back-2\" ;\n  }\n  getColor(sPickupOn: string): string\n  {\n    var inputDate = new Date(sPickupOn);\n    var todaysDate = new Date();\n\n    var bToday = (inputDate.setHours(0,0,0,0) == todaysDate.setHours(0,0,0,0));\n\n    if ( bToday )\n      return \"#E4FCF7\" ;\n    return \"#FFE5E5\" ;\n  }\n  onSearchInput() {\n    this.bSearching = true;\n    this.oItems = this.filterItems(this.sText);\n    this.oItemGroupedByDate = this.groupByDate();\n    this.bSearching = false;\n  }\n  filterItems(sText: string) {\n    if (sText.length == 0)\n      return this.oAllItems;\n    return this.oAllItems.filter((item) => {\n      if ( item.CUSTOMER_NAME.toLowerCase().indexOf(sText.toLowerCase()) > -1 )\n        return true ;\n      if ( item.BOOKINGREF.indexOf(sText) > -1 )\n        return true ;\n      return false ;\n    });\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/order-history/order-history.ts"],"sourceRoot":""}